---
import { type CollectionEntry } from "astro:content"
import { readingTime, sortTags } from "@utils/helpers"

import Main from "@layouts/Main.astro"
import Link from "@components/Link.astro"
import Tag from "@components/Tag.astro"
import PostNavigation from "@components/PostNavigation.astro"
import Heading from "@components/Heading.astro"
import Date from "@components/Date.astro"

interface Props {
    previousPost?: CollectionEntry<"posts"> | null
    nextPost?: CollectionEntry<"posts"> | null
    post: CollectionEntry<"posts">
}

const { previousPost, nextPost, post } = Astro.props as Props

const { title, description, type, kind, tags, date } = post.data
---

<Main title={ title } description={ description }>
    <article>
        <div class="mx-auto">
            <div class="flex flex-col gap-y-2 my-8 max-w-full mx-auto px-2">
                <Link url="/#posts" text="Back" icon={{ name: "arrow-big-left-lines", side: "left" }} animated />
                <div class="mt-4 flex flex-wrap gap-2">
                    <Tag>{ type }</Tag>
                    |
                    {
                        sortTags(kind).map((k) => (
                            <Tag>{ k }</Tag>
                        ))
                    }
                </div>
                <Heading>{ title }</Heading>
                <div class="flex flex-row gap-x-2 items-center">
                    <div class="flex flex-row gap-x-1 items-center">
                        <span>üìÖ</span>
                        <Date date={ date } format="medium" />
                    </div>
                    <span>‚Ä¢</span>
                    <span class="text-sm">‚è∞ { `${ readingTime(post.body) } min read` }</span>
                </div>

                <div class="flex flex-wrap gap-2">
                    {
                        sortTags(tags).map((tag) => (
                            <Tag>{ `${ tag.toUpperCase() }` }</Tag>
                        ))
                    }
                </div>
            </div>
            <div class="prose max-w-full mx-auto px-2">
                <slot />
            </div>

            <PostNavigation
                previousPost={previousPost}
                nextPost={nextPost}
            />
        </div>
    </article>
</Main>
