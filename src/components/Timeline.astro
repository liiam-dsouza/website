---
import { experienceJson } from "@content/experience"
import { formatDuration, sortTags } from "@utils/helpers"
import Duration from "./Duration.astro"
import Subheading from "./Subheading.astro"
import Tag from "./Tag.astro"
import { getCollection } from "astro:content"

const experience = (await getCollection("experience")).sort((a, b) =>
    b.data.startDate.getTime() - a.data.startDate.getTime()
)
---

{
    experience.map((experience) => {
        const { startDate, endDate, role, company, description, skills } = experience.data
        return (
            <section class="my-2">
                <div class="flex flex-col md:flex-row md:justify-between">
                    <div>
                        <h3 class="text-xl font-medium">{ role }</h3>
                        <Subheading>{ company }</Subheading>
                    </div>
                    <div class="flex md:flex-col md:items-end gap-x-4">
                        <p class="font-semibold"><Duration start={ startDate } end={ endDate } /></p>
                        <p class="text-neutral-500 md:block hidden">{ formatDuration(startDate, endDate ? endDate : new Date()) }</p>
                    </div>
                </div>
                {/* <p>{ description }</p> */}

                <div class="my-2 flex flex-wrap gap-2">
                    {
                        sortTags(skills).map((skill) => (
                            <Tag>{ skill }</Tag>
                        ))
                    }
                </div>
            </section>
        )
    })
}
